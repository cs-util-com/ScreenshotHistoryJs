<!-- User Stories & Requirements for the code below:

- This is a template for a single-page HTML web app.
- A monospace font should be used.
- No backend; all data is stored locally.

Main user stories:
- ...

Keep this comment block in the code.
Simplify the code if possible (without removing the functionality described above). 
You MUST keep all comments in the code below, even if you think they are redundant.
Always respond with the full new html file (including these comments here), 
additional explanations what you change are nice to have but not necessary. 
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Screenshot History</title>
  <link href="style.css" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <!-- Favicon: A white box --> <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23fff'/%3E%3C/svg%3E" type="image/svg+xml">
  <!-- Added Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @view-transition {
      navigation: auto;
    }
    
    nav a[aria-current="page"]:after {
      border-color: white;
      view-transition-name: posts-nav;
    }
    
    /* Old stuff going out */
    ::view-transition-old(posts-nav) {
      animation: fade 0.2s linear forwards;
      height: 100%;
    }
    
    /* New stuff coming in */
    ::view-transition-new(posts-nav) {
      animation: fade 0.3s linear reverse;
      height: 100%;
    }
    
    @keyframes fade {
      from { opacity: 1; }
      to { opacity: 0; }
    }
  </style>
  <script>
    // Only use if browser supports View Transitions
    if (document.startViewTransition) {
      window.addEventListener('click', (e) => {
        // Only handle internal links
        if (e.target.tagName === 'A' && e.target.origin === window.location.origin) {
          e.preventDefault();
          document.startViewTransition(() => {
            window.location.href = e.target.href;
          });
        }
      });
    }
  </script>
</head>
<body class="dark:bg-gray-900 dark:text-white">
  <div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Screenshot History</h1>

    <div class="mb-4 flex items-center">
      <button id="startCapture" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2">
        Start Capture
      </button>
      <button id="pauseCapture" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded mr-2 hidden">
        Pause Capture
      </button>
      <button id="selectFolder" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mr-2">
        Select Folder
      </button>
      <span id="folderPath" class="ml-2">No folder selected</span>
      <button id="openSettings" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded ml-auto">
        Settings
      </button>
    </div>

    <div id="folderDisplay" class="mb-4">
      <!-- Folder path will be displayed here -->
    </div>

    <div class="mb-4">
      <input type="text" id="search" placeholder="Search..."
        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:text-white">
    </div>

    <div id="imageGrid" class="grid gap-4">
      <!-- Images will be loaded here -->
    </div>

    <div id="dailyGroups">
      <!-- Daily grouped images will be loaded here -->
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title"
    role="dialog" aria-modal="true">
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
      <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
      <div
        class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
        <div class="bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
          <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
            Settings
          </h3>
          <div class="mt-2">
            <div class="mb-4">
              <label for="imageQuality" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Image
                Quality (JPEG):</label>
              <input type="number" id="imageQuality" min="1" max="100" value="80"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:text-white">
            </div>
            <div class="mb-4">
              <label for="diffThreshold" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Diff
                Threshold (%):</label>
              <input type="number" id="diffThreshold" min="0" max="100" value="3"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:text-white">
            </div>
            <div class="mb-4">
              <label for="retentionPeriod" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Retention
                Period (days):</label>
              <input type="number" id="retentionPeriod" min="1" value="90"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:text-white">
            </div>
            <div class="mb-4">
              <label for="ocrLanguage" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">OCR
                Language:</label>
              <input type="text" id="ocrLanguage" value="eng"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:text-white">
            </div>
          </div>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
          <button id="saveSettings" type="button"
            class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
            Save
          </button>
          <button id="closeSettings" type="button"
            class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white dark:bg-gray-600 text-base font-medium text-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/dexie@3.2.2/dist/dexie.min.js"></script>
  <script src="https://unpkg.com/tesseract.js@v4.0.0/dist/tesseract.min.js"></script>
  <script src="main.js"></script>
</body>
</html>